<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>TimeChart Demo (Basic)</title>
    </head>
    <body>
        <div id="chart" style="width: 100%; height: 640px"></div>

        <script type="module">
            import { TimeChart } from "../dist/timechart.js";
            const el = document.getElementById("chart");

            let traceColors = [
                "black",
                "#1da308",
                "#e3382b",
                "lightGray",
                "gold",
                "#0269fa",
                "#a83291",
                "#eb920e",
                "#eb0ed9",
                "#f2eb5c",
            ];

            const count = 2;
            for (let i = 0; i < count; i++) {
                traceColors = traceColors.concat(...traceColors);
            }

            const makeTrace = (name, color) => {
                const data = [];
                return {
                    data,
                    name,
                    color,
                    lineWidth: 3,
                    lineType: TimeChart.LineType.Line,
                };
            };

            const series = traceColors.map((color, i) =>
                makeTrace(`Trace ${i}`, color)
            );

            const xMax = 10000;

            const chart = new TimeChart(el, {
                series,
                xRange: { min: 0, max: xMax },
                realTime: true,
                zoom: {
                    x: {
                        autoRange: true,
                        minDomainExtent: 50,
                    },
                    y: {
                        autoRange: true,
                        minDomainExtent: 1,
                    },
                },
                tooltip: {
                    enabled: true,
                    // xFormatter: (x) =>
                    //     new Date(x + baseTime).toLocaleString([], {
                    //         hour: "2-digit",
                    //         minute: "2-digit",
                    //         second: "2-digit",
                    //         fractionalSecondDigits: 3,
                    //     }),
                },
            });

            let X = 0;
            requestAnimationFrame(function update() {
                for (let i = 0; i < series.length; i++) {
                    series.map((trace, j) => {
                        trace.data.push({
                            x: X,
                            y: Math.sin((X * 2 * Math.PI) / (xMax / 10)) + j,
                        });
                    });
                    X += 1;
                }
                chart.update();
                requestAnimationFrame(update);
            });
        </script>
    </body>
</html>
